# -*- coding: utf-8 -*-
"""app.py

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1X-Jho497RQtL6ejVHXpbS2DO5s-TZYkc
"""

# 📄 app.py — CityScope AI Chatbot


import streamlit as st
import pandas as pd
import joblib
import random

# === Setup ===
st.set_page_config(page_title="CityScope AI", layout="centered")
st.title("🏙️ CityScope AI Chatbot")

# === Load model and data ===
model = joblib.load("model.pkl")
vectorizer = joblib.load("vectorizer.pkl")
data = pd.read_excel("cityscopedata.xlsx")

questions = data['Question'].astype(str).tolist()
answers = data['Answer'].astype(str).tolist()

# === Fixed English Question Tips ===
english_tips = [
    "What is the population of Namakkal district?",
    "How many villages are there in Tirunelveli?",
    "Tell me about healthcare facilities in Madurai.",
    "What are the key educational institutions in Salem?",
    "Is Coimbatore more urban or rural?",
    "How many towns are in Kanyakumari?",
    "What industries are famous in Thoothukudi?"
]

random.shuffle(english_tips)

with st.expander("💡 Question Tips (Click to expand)", expanded=True):
    st.markdown("Try asking:")
    for tip in english_tips:
        st.markdown(f"- {tip}")
    st.button("🔁 Refresh Tips", on_click=st.rerun)

# === User Input ===
user_query = st.text_input("✍️ Ask something about Tamil Nadu's districts:")

# === Clear Button ===
if st.button("🧹 Clear All"):
    st.experimental_rerun()

# === Answer Output ===
if user_query:
    query_vec = vectorizer.transform([user_query])
    dist, index = model.kneighbors(query_vec, n_neighbors=1)
    matched_index = index[0][0]

    st.markdown("### 🧠 Answer:")
    st.success(answers[matched_index])
